<!-- Code generated by gomarkdoc. DO NOT EDIT -->

```go
import "github.com/Azure/iot-operations-sdks/go/protocol"
```

## Index

- [Constants](<#constants>)
- [Variables](<#variables>)
- [func WithLogger\(logger \*slog.Logger\) interface \{
    Option
    CommandExecutorOption
    CommandInvokerOption
    TelemetryReceiverOption
    TelemetrySenderOption
\}](<#WithLogger>)
- [type CloudEvent](<#CloudEvent>)
  - [func \(ce \*CloudEvent\) Attrs\(\) \[\]slog.Attr](<#CloudEvent.Attrs>)
- [type CommandExecutor](<#CommandExecutor>)
  - [func NewCommandExecutor\[Req, Res any\]\(client MqttClient, requestEncoding Encoding\[Req\], responseEncoding Encoding\[Res\], requestTopicPattern string, handler CommandHandler\[Req, Res\], opt ...CommandExecutorOption\) \(ce \*CommandExecutor\[Req, Res\], err error\)](<#NewCommandExecutor>)
  - [func \(ce \*CommandExecutor\[Req, Res\]\) Close\(\)](<#CommandExecutor[Req, Res].Close>)
  - [func \(ce \*CommandExecutor\[Req, Res\]\) Start\(ctx context.Context\) error](<#CommandExecutor[Req, Res].Start>)
- [type CommandExecutorOption](<#CommandExecutorOption>)
- [type CommandExecutorOptions](<#CommandExecutorOptions>)
  - [func \(o \*CommandExecutorOptions\) Apply\(opts \[\]CommandExecutorOption, rest ...CommandExecutorOption\)](<#CommandExecutorOptions.Apply>)
  - [func \(o \*CommandExecutorOptions\) ApplyOptions\(opts \[\]Option, rest ...Option\)](<#CommandExecutorOptions.ApplyOptions>)
- [type CommandHandler](<#CommandHandler>)
- [type CommandInvoker](<#CommandInvoker>)
  - [func NewCommandInvoker\[Req, Res any\]\(client MqttClient, requestEncoding Encoding\[Req\], responseEncoding Encoding\[Res\], requestTopicPattern string, opt ...CommandInvokerOption\) \(ci \*CommandInvoker\[Req, Res\], err error\)](<#NewCommandInvoker>)
  - [func \(ci \*CommandInvoker\[Req, Res\]\) Close\(\)](<#CommandInvoker[Req, Res].Close>)
  - [func \(ci \*CommandInvoker\[Req, Res\]\) Invoke\(ctx context.Context, req Req, opt ...InvokeOption\) \(res \*CommandResponse\[Res\], err error\)](<#CommandInvoker[Req, Res].Invoke>)
  - [func \(ci \*CommandInvoker\[Req, Res\]\) Start\(ctx context.Context\) error](<#CommandInvoker[Req, Res].Start>)
- [type CommandInvokerOption](<#CommandInvokerOption>)
- [type CommandInvokerOptions](<#CommandInvokerOptions>)
  - [func \(o \*CommandInvokerOptions\) Apply\(opts \[\]CommandInvokerOption, rest ...CommandInvokerOption\)](<#CommandInvokerOptions.Apply>)
  - [func \(o \*CommandInvokerOptions\) ApplyOptions\(opts \[\]Option, rest ...Option\)](<#CommandInvokerOptions.ApplyOptions>)
- [type CommandRequest](<#CommandRequest>)
- [type CommandResponse](<#CommandResponse>)
  - [func Respond\[Res any\]\(payload Res, opt ...RespondOption\) \(\*CommandResponse\[Res\], error\)](<#Respond>)
- [type Data](<#Data>)
  - [func \(Data\) Deserialize\(data \*Data\) \(\*Data, error\)](<#Data.Deserialize>)
  - [func \(Data\) Serialize\(t \*Data\) \(\*Data, error\)](<#Data.Serialize>)
- [type Empty](<#Empty>)
  - [func \(Empty\) Deserialize\(data \*Data\) \(any, error\)](<#Empty.Deserialize>)
  - [func \(Empty\) Serialize\(t any\) \(\*Data, error\)](<#Empty.Serialize>)
- [type Encoding](<#Encoding>)
- [type InvocationError](<#InvocationError>)
  - [func \(e InvocationError\) Error\(\) string](<#InvocationError.Error>)
- [type InvokeOption](<#InvokeOption>)
- [type InvokeOptions](<#InvokeOptions>)
  - [func \(o \*InvokeOptions\) Apply\(opts \[\]InvokeOption, rest ...InvokeOption\)](<#InvokeOptions.Apply>)
- [type JSON](<#JSON>)
  - [func \(JSON\[T\]\) Deserialize\(data \*Data\) \(T, error\)](<#JSON[T].Deserialize>)
  - [func \(JSON\[T\]\) Serialize\(t T\) \(\*Data, error\)](<#JSON[T].Serialize>)
- [type Listener](<#Listener>)
- [type Listeners](<#Listeners>)
  - [func \(ls Listeners\) Close\(\)](<#Listeners.Close>)
  - [func \(ls Listeners\) Start\(ctx context.Context\) error](<#Listeners.Start>)
- [type Message](<#Message>)
- [type MqttClient](<#MqttClient>)
- [type Option](<#Option>)
- [type Raw](<#Raw>)
  - [func \(Raw\) Deserialize\(data \*Data\) \(\[\]byte, error\)](<#Raw.Deserialize>)
  - [func \(Raw\) Serialize\(t \[\]byte\) \(\*Data, error\)](<#Raw.Serialize>)
- [type RespondOption](<#RespondOption>)
- [type RespondOptions](<#RespondOptions>)
  - [func \(o \*RespondOptions\) Apply\(opts \[\]RespondOption, rest ...RespondOption\)](<#RespondOptions.Apply>)
- [type SendOption](<#SendOption>)
  - [func WithCloudEvent\(ce \*CloudEvent\) SendOption](<#WithCloudEvent>)
- [type SendOptions](<#SendOptions>)
  - [func \(o \*SendOptions\) Apply\(opts \[\]SendOption, rest ...SendOption\)](<#SendOptions.Apply>)
- [type TelemetryHandler](<#TelemetryHandler>)
- [type TelemetryMessage](<#TelemetryMessage>)
- [type TelemetryReceiver](<#TelemetryReceiver>)
  - [func NewTelemetryReceiver\[T any\]\(client MqttClient, encoding Encoding\[T\], topicPattern string, handler TelemetryHandler\[T\], opt ...TelemetryReceiverOption\) \(tr \*TelemetryReceiver\[T\], err error\)](<#NewTelemetryReceiver>)
  - [func \(tr \*TelemetryReceiver\[T\]\) Close\(\)](<#TelemetryReceiver[T].Close>)
  - [func \(tr \*TelemetryReceiver\[T\]\) Start\(ctx context.Context\) error](<#TelemetryReceiver[T].Start>)
- [type TelemetryReceiverOption](<#TelemetryReceiverOption>)
- [type TelemetryReceiverOptions](<#TelemetryReceiverOptions>)
  - [func \(o \*TelemetryReceiverOptions\) Apply\(opts \[\]TelemetryReceiverOption, rest ...TelemetryReceiverOption\)](<#TelemetryReceiverOptions.Apply>)
  - [func \(o \*TelemetryReceiverOptions\) ApplyOptions\(opts \[\]Option, rest ...Option\)](<#TelemetryReceiverOptions.ApplyOptions>)
- [type TelemetrySender](<#TelemetrySender>)
  - [func NewTelemetrySender\[T any\]\(client MqttClient, encoding Encoding\[T\], topicPattern string, opt ...TelemetrySenderOption\) \(ts \*TelemetrySender\[T\], err error\)](<#NewTelemetrySender>)
  - [func \(ts \*TelemetrySender\[T\]\) Send\(ctx context.Context, val T, opt ...SendOption\) \(err error\)](<#TelemetrySender[T].Send>)
- [type TelemetrySenderOption](<#TelemetrySenderOption>)
- [type TelemetrySenderOptions](<#TelemetrySenderOptions>)
  - [func \(o \*TelemetrySenderOptions\) Apply\(opts \[\]TelemetrySenderOption, rest ...TelemetrySenderOption\)](<#TelemetrySenderOptions.Apply>)
  - [func \(o \*TelemetrySenderOptions\) ApplyOptions\(opts \[\]Option, rest ...Option\)](<#TelemetrySenderOptions.ApplyOptions>)
- [type WithCacheTTL](<#WithCacheTTL>)
- [type WithConcurrency](<#WithConcurrency>)
- [type WithDataSchema](<#WithDataSchema>)
- [type WithFencingToken](<#WithFencingToken>)
- [type WithIdempotent](<#WithIdempotent>)
- [type WithManualAck](<#WithManualAck>)
- [type WithMetadata](<#WithMetadata>)
- [type WithResponseTopic](<#WithResponseTopic>)
- [type WithResponseTopicPrefix](<#WithResponseTopicPrefix>)
- [type WithResponseTopicSuffix](<#WithResponseTopicSuffix>)
- [type WithRetain](<#WithRetain>)
- [type WithShareName](<#WithShareName>)
- [type WithTimeout](<#WithTimeout>)
- [type WithTopicNamespace](<#WithTopicNamespace>)
- [type WithTopicTokenNamespace](<#WithTopicTokenNamespace>)
- [type WithTopicTokens](<#WithTopicTokens>)


## Constants

<a name="DefaultCloudEventSpecVersion"></a>

```go
const (
    DefaultCloudEventSpecVersion = "1.0"
    DefaultCloudEventType        = "ms.aio.telemetry"
)
```

<a name="DefaultTimeout"></a>DefaultTimeout is the timeout applied to Invoke or Send if none is specified.

```go
const DefaultTimeout = 10 * time.Second
```

## Variables

<a name="ErrUnsupportedContentType"></a>ErrUnsupportedContentType should be returned if the content type is not supported by this encoding.

```go
var ErrUnsupportedContentType = stderr.New("unsupported content type")
```

<a name="WithLogger"></a>
## func [WithLogger](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L205-L211>)

```go
func WithLogger(logger *slog.Logger) interface {
    Option
    CommandExecutorOption
    CommandInvokerOption
    TelemetryReceiverOption
    TelemetrySenderOption
}
```

WithLogger enables logging with the provided slog logger.

<a name="CloudEvent"></a>
## type [CloudEvent](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_cloud_event.go#L18-L28>)

CloudEvent provides an implementation of the CloudEvents 1.0 spec; see: https://github.com/cloudevents/spec/blob/main/cloudevents/spec.md

```go
type CloudEvent struct {
    ID          string
    Source      *url.URL
    SpecVersion string
    Type        string

    DataContentType string
    DataSchema      *url.URL
    Subject         string
    Time            time.Time
}
```

<a name="CloudEvent.Attrs"></a>
### func \(\*CloudEvent\) [Attrs](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_cloud_event.go#L56>)

```go
func (ce *CloudEvent) Attrs() []slog.Attr
```

Attrs returns additional attributes for slog.

<a name="CommandExecutor"></a>
## type [CommandExecutor](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L24-L30>)

CommandExecutor provides the ability to execute a single command.

```go
type CommandExecutor[Req any, Res any] struct {
    // contains filtered or unexported fields
}
```

<a name="NewCommandExecutor"></a>
### func [NewCommandExecutor](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L88-L95>)

```go
func NewCommandExecutor[Req, Res any](client MqttClient, requestEncoding Encoding[Req], responseEncoding Encoding[Res], requestTopicPattern string, handler CommandHandler[Req, Res], opt ...CommandExecutorOption) (ce *CommandExecutor[Req, Res], err error)
```

NewCommandExecutor creates a new command executor.

<a name="CommandExecutor[Req, Res].Close"></a>
### func \(\*CommandExecutor\[Req, Res\]\) [Close](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L190>)

```go
func (ce *CommandExecutor[Req, Res]) Close()
```

Close the command executor to free its resources.

<a name="CommandExecutor[Req, Res].Start"></a>
### func \(\*CommandExecutor\[Req, Res\]\) [Start](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L185>)

```go
func (ce *CommandExecutor[Req, Res]) Start(ctx context.Context) error
```

Start listening to the MQTT request topic.

<a name="CommandExecutorOption"></a>
## type [CommandExecutorOption](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L33>)

CommandExecutorOption represents a single command executor option.

```go
type CommandExecutorOption interface {
    // contains filtered or unexported methods
}
```

<a name="CommandExecutorOptions"></a>
## type [CommandExecutorOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L36-L47>)

CommandExecutorOptions are the resolved command executor options.

```go
type CommandExecutorOptions struct {
    Idempotent bool
    CacheTTL   time.Duration

    Concurrency uint
    Timeout     time.Duration
    ShareName   string

    TopicNamespace string
    TopicTokens    map[string]string
    Logger         *slog.Logger
}
```

<a name="CommandExecutorOptions.Apply"></a>
### func \(\*CommandExecutorOptions\) [Apply](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L419-L422>)

```go
func (o *CommandExecutorOptions) Apply(opts []CommandExecutorOption, rest ...CommandExecutorOption)
```

Apply resolves the provided list of options.

<a name="CommandExecutorOptions.ApplyOptions"></a>
### func \(\*CommandExecutorOptions\) [ApplyOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L429>)

```go
func (o *CommandExecutorOptions) ApplyOptions(opts []Option, rest ...Option)
```

ApplyOptions filters and resolves the provided list of options.

<a name="CommandHandler"></a>
## type [CommandHandler](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L52-L55>)

CommandHandler is the user\-provided implementation of a single command execution. It is treated as blocking; all parallelism is handled by the library. This \*must\* be thread\-safe.

```go
type CommandHandler[Req any, Res any] func(
    context.Context,
    *CommandRequest[Req],
) (*CommandResponse[Res], error)
```

<a name="CommandInvoker"></a>
## type [CommandInvoker](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L23-L29>)

CommandInvoker provides the ability to invoke a single command.

```go
type CommandInvoker[Req any, Res any] struct {
    // contains filtered or unexported fields
}
```

<a name="NewCommandInvoker"></a>
### func [NewCommandInvoker](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L86-L92>)

```go
func NewCommandInvoker[Req, Res any](client MqttClient, requestEncoding Encoding[Req], responseEncoding Encoding[Res], requestTopicPattern string, opt ...CommandInvokerOption) (ci *CommandInvoker[Req, Res], err error)
```

NewCommandInvoker creates a new command invoker.

<a name="CommandInvoker[Req, Res].Close"></a>
### func \(\*CommandInvoker\[Req, Res\]\) [Close](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L300>)

```go
func (ci *CommandInvoker[Req, Res]) Close()
```

Close the command invoker to free its resources.

<a name="CommandInvoker[Req, Res].Invoke"></a>
### func \(\*CommandInvoker\[Req, Res\]\) [Invoke](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L185-L189>)

```go
func (ci *CommandInvoker[Req, Res]) Invoke(ctx context.Context, req Req, opt ...InvokeOption) (res *CommandResponse[Res], err error)
```

Invoke calls the command. This call will block until the command returns; any desired parallelism between invocations should be handled by the caller using normal Go constructs.

<a name="CommandInvoker[Req, Res].Start"></a>
### func \(\*CommandInvoker\[Req, Res\]\) [Start](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L295>)

```go
func (ci *CommandInvoker[Req, Res]) Start(ctx context.Context) error
```

Start listening to the response topic\(s\). Must be called before any calls to Invoke.

<a name="CommandInvokerOption"></a>
## type [CommandInvokerOption](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L32>)

CommandInvokerOption represents a single command invoker option.

```go
type CommandInvokerOption interface {
    // contains filtered or unexported methods
}
```

<a name="CommandInvokerOptions"></a>
## type [CommandInvokerOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L35-L43>)

CommandInvokerOptions are the resolved command invoker options.

```go
type CommandInvokerOptions struct {
    ResponseTopic       func(string) string
    ResponseTopicPrefix string
    ResponseTopicSuffix string

    TopicNamespace string
    TopicTokens    map[string]string
    Logger         *slog.Logger
}
```

<a name="CommandInvokerOptions.Apply"></a>
### func \(\*CommandInvokerOptions\) [Apply](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L339-L342>)

```go
func (o *CommandInvokerOptions) Apply(opts []CommandInvokerOption, rest ...CommandInvokerOption)
```

Apply resolves the provided list of options.

<a name="CommandInvokerOptions.ApplyOptions"></a>
### func \(\*CommandInvokerOptions\) [ApplyOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L349>)

```go
func (o *CommandInvokerOptions) ApplyOptions(opts []Option, rest ...Option)
```

ApplyOptions filters and resolves the provided list of options.

<a name="CommandRequest"></a>
## type [CommandRequest](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L59-L61>)

CommandRequest contains per\-message data and methods that are exposed to the command handlers.

```go
type CommandRequest[Req any] struct {
    // contains filtered or unexported fields
}
```

<a name="CommandResponse"></a>
## type [CommandResponse](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L65-L67>)

CommandResponse contains per\-message data and methods that are returned by the command handlers.

```go
type CommandResponse[Res any] struct {
    // contains filtered or unexported fields
}
```

<a name="Respond"></a>
### func [Respond](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L402-L405>)

```go
func Respond[Res any](payload Res, opt ...RespondOption) (*CommandResponse[Res], error)
```

Respond is a shorthand to create a command response with required values and options set appropriately. Note that the response may be incomplete and will be filled out by the library after being returned.

<a name="Data"></a>
## type [Data](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L24-L28>)

Data represents encoded values along with their transmitted content type. It may also be provided as the encoding to act as a passthrough, allowing the calling code to fully specify the data manually.

```go
type Data struct {
    Payload       []byte
    ContentType   string
    PayloadFormat byte
}
```

<a name="Data.Deserialize"></a>
### func \(Data\) [Deserialize](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L146>)

```go
func (Data) Deserialize(data *Data) (*Data, error)
```

Deserialize returns the data unchanged.

<a name="Data.Serialize"></a>
### func \(Data\) [Serialize](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L141>)

```go
func (Data) Serialize(t *Data) (*Data, error)
```

Serialize returns the data unchanged.

<a name="Empty"></a>
## type [Empty](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L34>)

Empty represents an encoding that contains no value.

```go
type Empty struct{}
```

<a name="Empty.Deserialize"></a>
### func \(Empty\) [Deserialize](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L115>)

```go
func (Empty) Deserialize(data *Data) (any, error)
```

Deserialize validates that the payload is empty.

<a name="Empty.Serialize"></a>
### func \(Empty\) [Serialize](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L104>)

```go
func (Empty) Serialize(t any) (*Data, error)
```

Serialize validates that the payload is empty.

<a name="Encoding"></a>
## type [Encoding](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L16-L19>)

Encoding is a translation between a concrete Go type T and encoded data. All methods \*must\* be thread\-safe.

```go
type Encoding[T any] interface {
    Serialize(T) (*Data, error)
    Deserialize(*Data) (T, error)
}
```

<a name="InvocationError"></a>
## type [InvocationError](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/types.go#L61-L65>)

InvocationError represents an error intentionally returned by a handler to indicate incorrect invocation.

```go
type InvocationError struct {
    Message       string
    PropertyName  string
    PropertyValue any
}
```

<a name="InvocationError.Error"></a>
### func \(InvocationError\) [Error](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/types.go#L73>)

```go
func (e InvocationError) Error() string
```

Error returns the invocation error as a string.

<a name="InvokeOption"></a>
## type [InvokeOption](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L46>)

InvokeOption represent a single per\-invoke option.

```go
type InvokeOption interface {
    // contains filtered or unexported methods
}
```

<a name="InvokeOptions"></a>
## type [InvokeOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L49-L53>)

InvokeOptions are the resolved per\-invoke options.

```go
type InvokeOptions struct {
    Timeout     time.Duration
    TopicTokens map[string]string
    Metadata    map[string]string
}
```

<a name="InvokeOptions.Apply"></a>
### func \(\*InvokeOptions\) [Apply](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L382-L385>)

```go
func (o *InvokeOptions) Apply(opts []InvokeOption, rest ...InvokeOption)
```

Apply resolves the provided list of options.

<a name="JSON"></a>
## type [JSON](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L31>)

JSON is a simple implementation of a JSON encoding.

```go
type JSON[T any] struct{}
```

<a name="JSON[T].Deserialize"></a>
### func \(JSON\[T\]\) [Deserialize](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L92>)

```go
func (JSON[T]) Deserialize(data *Data) (T, error)
```

Deserialize translates JSON bytes into the Go type T.

<a name="JSON[T].Serialize"></a>
### func \(JSON\[T\]\) [Serialize](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L83>)

```go
func (JSON[T]) Serialize(t T) (*Data, error)
```

Serialize translates the Go type T into JSON bytes.

<a name="Listener"></a>
## type [Listener](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/listener.go#L22-L25>)

Listener represents an object which will listen to a MQTT topic.

```go
type Listener interface {
    Start(context.Context) error
    Close()
}
```

<a name="Listeners"></a>
## type [Listeners](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/listener.go#L28>)

Listeners represents a collection of MQTT listeners.

```go
type Listeners []Listener
```

<a name="Listeners.Close"></a>
### func \(Listeners\) [Close](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/listener.go#L195>)

```go
func (ls Listeners) Close()
```

Close all underlying MQTT topics and free resources.

<a name="Listeners.Start"></a>
### func \(Listeners\) [Start](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/listener.go#L185>)

```go
func (ls Listeners) Start(ctx context.Context) error
```

Start listening to all underlying MQTT topics.

<a name="Message"></a>
## type [Message](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/types.go#L36-L57>)

Message contains common message data that is exposed to message handlers.

```go
type Message[T any] struct {
    // The message payload.
    Payload T

    // The ID of the calling MQTT client.
    ClientID string

    // The data that identifies a single unique request.
    CorrelationData string

    // The timestamp of when the message was sent.
    Timestamp hlc.HybridLogicalClock

    // All topic tokens resolved from the incoming topic.
    TopicTokens map[string]string

    // Any user-provided metadata values.
    Metadata map[string]string

    // The raw payload data.
    *Data
}
```

<a name="MqttClient"></a>
## type [MqttClient](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/types.go#L14-L33>)

MqttClient is the client used for the underlying MQTT connection.

```go
type MqttClient interface {
    ID() string
    Publish(
        context.Context,
        string,
        []byte,
        ...mqtt.PublishOption,
    ) (*mqtt.Ack, error)
    RegisterMessageHandler(mqtt.MessageHandler) func()
    Subscribe(
        context.Context,
        string,
        ...mqtt.SubscribeOption,
    ) (*mqtt.Ack, error)
    Unsubscribe(
        context.Context,
        string,
        ...mqtt.UnsubscribeOption,
    ) (*mqtt.Ack, error)
}
```

<a name="Option"></a>
## type [Option](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/types.go#L69>)

Option represents any of the option types, and can be filtered and applied by the ApplyOptions methods on the option structs.

```go
type Option interface {
    // contains filtered or unexported methods
}
```

<a name="Raw"></a>
## type [Raw](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L37>)

Raw represents a raw byte stream.

```go
type Raw struct{}
```

<a name="Raw.Deserialize"></a>
### func \(Raw\) [Deserialize](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L131>)

```go
func (Raw) Deserialize(data *Data) ([]byte, error)
```

Deserialize returns the bytes unchanged.

<a name="Raw.Serialize"></a>
### func \(Raw\) [Serialize](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/encoding.go#L126>)

```go
func (Raw) Serialize(t []byte) (*Data, error)
```

Serialize returns the bytes unchanged.

<a name="RespondOption"></a>
## type [RespondOption](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L77>)

RespondOption represent a single per\-response option.

```go
type RespondOption interface {
    // contains filtered or unexported methods
}
```

<a name="RespondOptions"></a>
## type [RespondOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L80-L82>)

RespondOptions are the resolved per\-response options.

```go
type RespondOptions struct {
    Metadata map[string]string
}
```

<a name="RespondOptions.Apply"></a>
### func \(\*RespondOptions\) [Apply](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L456-L459>)

```go
func (o *RespondOptions) Apply(opts []RespondOption, rest ...RespondOption)
```

Apply resolves the provided list of options.

<a name="SendOption"></a>
## type [SendOption](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L38>)

SendOption represent a single per\-send option.

```go
type SendOption interface {
    // contains filtered or unexported methods
}
```

<a name="WithCloudEvent"></a>
### func [WithCloudEvent](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L191>)

```go
func WithCloudEvent(ce *CloudEvent) SendOption
```

WithCloudEvent adds a cloud event payload to the telemetry message.

<a name="SendOptions"></a>
## type [SendOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L41-L48>)

SendOptions are the resolved per\-send options.

```go
type SendOptions struct {
    CloudEvent *CloudEvent
    Retain     bool

    Timeout     time.Duration
    TopicTokens map[string]string
    Metadata    map[string]string
}
```

<a name="SendOptions.Apply"></a>
### func \(\*SendOptions\) [Apply](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L171-L174>)

```go
func (o *SendOptions) Apply(opts []SendOption, rest ...SendOption)
```

Apply resolves the provided list of options.

<a name="TelemetryHandler"></a>
## type [TelemetryHandler](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L50>)

TelemetryHandler is the user\-provided implementation of a single telemetry event handler. It is treated as blocking; all parallelism is handled by the library. This \*must\* be thread\-safe.

```go
type TelemetryHandler[T any] func(context.Context, *TelemetryMessage[T]) error
```

<a name="TelemetryMessage"></a>
## type [TelemetryMessage](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L54-L64>)

TelemetryMessage contains per\-message data and methods that are exposed to the telemetry handlers.

```go
type TelemetryMessage[T any] struct {

    // CloudEvent will be present if the message was sent with cloud events.
    *CloudEvent

    // Ack provides a function to manually ack if enabled and if possible;
    // it will be nil otherwise. Note that, since QoS 0 messages cannot be
    // acked, this will be nil in this case even if manual ack is enabled.
    Ack func()
    // contains filtered or unexported fields
}
```

<a name="TelemetryReceiver"></a>
## type [TelemetryReceiver](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L22-L27>)

TelemetryReceiver provides the ability to handle the receipt of a single telemetry.

```go
type TelemetryReceiver[T any] struct {
    // contains filtered or unexported fields
}
```

<a name="NewTelemetryReceiver"></a>
### func [NewTelemetryReceiver](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L74-L80>)

```go
func NewTelemetryReceiver[T any](client MqttClient, encoding Encoding[T], topicPattern string, handler TelemetryHandler[T], opt ...TelemetryReceiverOption) (tr *TelemetryReceiver[T], err error)
```

NewTelemetryReceiver creates a new telemetry receiver.

<a name="TelemetryReceiver[T].Close"></a>
### func \(\*TelemetryReceiver\[T\]\) [Close](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L147>)

```go
func (tr *TelemetryReceiver[T]) Close()
```

Close the telemetry receiver to free its resources.

<a name="TelemetryReceiver[T].Start"></a>
### func \(\*TelemetryReceiver\[T\]\) [Start](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L142>)

```go
func (tr *TelemetryReceiver[T]) Start(ctx context.Context) error
```

Start listening to the MQTT telemetry topic.

<a name="TelemetryReceiverOption"></a>
## type [TelemetryReceiverOption](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L30-L32>)

TelemetryReceiverOption represents a single telemetry receiver option.

```go
type TelemetryReceiverOption interface {
    // contains filtered or unexported methods
}
```

<a name="TelemetryReceiverOptions"></a>
## type [TelemetryReceiverOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L35-L45>)

TelemetryReceiverOptions are the resolved telemetry receiver options.

```go
type TelemetryReceiverOptions struct {
    ManualAck bool

    Concurrency uint
    Timeout     time.Duration
    ShareName   string

    TopicNamespace string
    TopicTokens    map[string]string
    Logger         *slog.Logger
}
```

<a name="TelemetryReceiverOptions.Apply"></a>
### func \(\*TelemetryReceiverOptions\) [Apply](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L253-L256>)

```go
func (o *TelemetryReceiverOptions) Apply(opts []TelemetryReceiverOption, rest ...TelemetryReceiverOption)
```

Apply resolves the provided list of options.

<a name="TelemetryReceiverOptions.ApplyOptions"></a>
### func \(\*TelemetryReceiverOptions\) [ApplyOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L263>)

```go
func (o *TelemetryReceiverOptions) ApplyOptions(opts []Option, rest ...Option)
```

ApplyOptions filters and resolves the provided list of options.

<a name="TelemetrySender"></a>
## type [TelemetrySender](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L19-L22>)

TelemetrySender provides the ability to send a single telemetry.

```go
type TelemetrySender[T any] struct {
    // contains filtered or unexported fields
}
```

<a name="NewTelemetrySender"></a>
### func [NewTelemetrySender](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L61-L66>)

```go
func NewTelemetrySender[T any](client MqttClient, encoding Encoding[T], topicPattern string, opt ...TelemetrySenderOption) (ts *TelemetrySender[T], err error)
```

NewTelemetrySender creates a new telemetry sender.

<a name="TelemetrySender[T].Send"></a>
### func \(\*TelemetrySender\[T\]\) [Send](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L102-L106>)

```go
func (ts *TelemetrySender[T]) Send(ctx context.Context, val T, opt ...SendOption) (err error)
```

Send emits the telemetry. This will block until the message is ack'd.

<a name="TelemetrySenderOption"></a>
## type [TelemetrySenderOption](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L25-L27>)

TelemetrySenderOption represents a single telemetry sender option.

```go
type TelemetrySenderOption interface {
    // contains filtered or unexported methods
}
```

<a name="TelemetrySenderOptions"></a>
## type [TelemetrySenderOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L30-L35>)

TelemetrySenderOptions are the resolved telemetry sender options.

```go
type TelemetrySenderOptions struct {
    DataSchema     *url.URL
    TopicNamespace string
    TopicTokens    map[string]string
    Logger         *slog.Logger
}
```

<a name="TelemetrySenderOptions.Apply"></a>
### func \(\*TelemetrySenderOptions\) [Apply](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L146-L149>)

```go
func (o *TelemetrySenderOptions) Apply(opts []TelemetrySenderOption, rest ...TelemetrySenderOption)
```

Apply resolves the provided list of options.

<a name="TelemetrySenderOptions.ApplyOptions"></a>
### func \(\*TelemetrySenderOptions\) [ApplyOptions](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L156>)

```go
func (o *TelemetrySenderOptions) ApplyOptions(opts []Option, rest ...Option)
```

ApplyOptions filters and resolves the provided list of options.

<a name="WithCacheTTL"></a>
## type [WithCacheTTL](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L74>)

WithCacheTTL indicates how long results of this command will live in the cache. This is only valid for idempotent commands.

```go
type WithCacheTTL time.Duration
```

<a name="WithConcurrency"></a>
## type [WithConcurrency](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L13>)

WithConcurrency indicates how many handlers can execute in parallel.

```go
type WithConcurrency uint
```

<a name="WithDataSchema"></a>
## type [WithDataSchema](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L35>)

WithDataSchema specifies a data schema that will be used for CloudEvents.

```go
type WithDataSchema url.URL
```

<a name="WithFencingToken"></a>
## type [WithFencingToken](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L67>)

WithFencingToken provides a fencing token to be used by the executor.

```go
type WithFencingToken hlc.HybridLogicalClock
```

<a name="WithIdempotent"></a>
## type [WithIdempotent](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_executor.go#L70>)

WithIdempotent marks the command as idempotent.

```go
type WithIdempotent bool
```

<a name="WithManualAck"></a>
## type [WithManualAck](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_receiver.go#L68>)

WithManualAck indicates that the handler is responsible for manually acking the telemetry message.

```go
type WithManualAck bool
```

<a name="WithMetadata"></a>
## type [WithMetadata](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L32>)

WithMetadata specifies user\-provided metadata values.

```go
type WithMetadata map[string]string
```

<a name="WithResponseTopic"></a>
## type [WithResponseTopic](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L58>)

WithResponseTopic specifies a translation function from the request topic to the response topic. Note that this overrides any provided response topic prefix or suffix.

```go
type WithResponseTopic func(string) string
```

<a name="WithResponseTopicPrefix"></a>
## type [WithResponseTopicPrefix](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L61>)

WithResponseTopicPrefix specifies a custom prefix for the response topic.

```go
type WithResponseTopicPrefix string
```

<a name="WithResponseTopicSuffix"></a>
## type [WithResponseTopicSuffix](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/command_invoker.go#L64>)

WithResponseTopicSuffix specifies a custom suffix for the response topic.

```go
type WithResponseTopicSuffix string
```

<a name="WithRetain"></a>
## type [WithRetain](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/telemetry_sender.go#L52>)

WithRetain indicates that the telemetry event should be retained by the broker.

```go
type WithRetain bool
```

<a name="WithShareName"></a>
## type [WithShareName](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L20>)

WithShareName connects this listener to a shared MQTT subscription.

```go
type WithShareName string
```

<a name="WithTimeout"></a>
## type [WithTimeout](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L17>)

WithTimeout applies a context timeout to the message invocation or handler execution, as appropriate.

```go
type WithTimeout time.Duration
```

<a name="WithTopicNamespace"></a>
## type [WithTopicNamespace](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L39>)

WithTopicNamespace specifies a namespace that will be prepended to the topic.

```go
type WithTopicNamespace string
```

<a name="WithTopicTokenNamespace"></a>
## type [WithTopicTokenNamespace](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L29>)

WithTopicTokenNamespace specifies a namespace that will be prepended to all previously\-specified topic tokens. Topic tokens specified after this option will not be namespaced, allowing this to differentiate user tokens from system tokens.

```go
type WithTopicTokenNamespace string
```

<a name="WithTopicTokens"></a>
## type [WithTopicTokens](<https://github.com/Azure/iot-operations-sdks/blob/main/go/protocol/common_options.go#L23>)

WithTopicTokens specifies topic token values.

```go
type WithTopicTokens map[string]string
```

Generated by [gomarkdoc](<https://github.com/princjef/gomarkdoc>)
