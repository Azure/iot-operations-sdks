{
  "@context": [
    "dtmi:dtdl:context;3",
    "dtmi:dtdl:extension:mqtt;1"
  ],
  "@id": "dtmi:com:microsoft:deviceregistry:DiscoveredAssetResources;1",
  "@type": [
    "Interface",
    "Mqtt"
  ],
  "displayName": "DiscoveredAssetResources",
  "commandTopic": "akri/discovery/{modelId}/{invokerClientId}/command/{commandName}",
  "payloadFormat": "Json/ecma/404",
  "contents": [
    {
      "@type": "Command",
      "name": "createDiscoveredAssetEndpointProfile",
      "request": {
        "name": "createDiscoveredAssetEndpointProfileRequest",
        "displayName": "Discovered Asset Endpoint Profile Create Request",
        "description": "Create a new discovered asset endpoint profile.",
        "schema": {
          "@type": "Object",
          "fields": [
            {
              "@type": "Field",
              "name": "daepName",
              "description": "Name of the discovered asset endpoint profile. If not provided it will get generated by Akri.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "targetAddress",
              "description": "local valid URI specifying the network address/dns name of southbound service.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "endpointProfileType",
              "description": "Defines the configuration for the connector type that is being used with the endpoint profile.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "supportedAuthenticationMethods",
              "description": "list of supported authentication methods",
              "schema": {
                "@type": "Array",
                "elementSchema": {
                  "@type": "Enum",
                  "valueSchema": "string",
                  "enumValues": [
                    {
                      "name": "Anonymous",
                      "enumValue": "Anonymous"
                    },
                    {
                      "name": "UsernamePassword",
                      "enumValue": "UsernamePassword"
                    },
                    {
                      "name": "Certificate",
                      "enumValue": "Certificate"
                    }
                  ]

                }
              }
            },
            {
              "@type": "Field",
              "name": "additionalConfiguration",
              "description": "A unique identifier for a discovered asset.",
              "schema": "string"
            }
          ]
        }
      },
      "response": {
        "name": "createDiscoveredAssetEndpointProfileResponse",
        "displayName": "Create Discovered Asset Endpoint Profile Response",
        "description": "Response to a discovered asset endpoint profile create request.",
        "schema": {
          "@type": "Object",
          "fields": [
            {
              "@type": "Field",
              "name": "status",
              "description": "status of discovered asset endpoint profile creation",
              "schema": {
                "@type": "Enum",
                "valueSchema": "string",
                "enumValues": [
                  {
                    "name": "Created",
                    "enumValue": "created"
                  },
                  {
                    "name": "Duplicate",
                    "enumValue": "duplicate"
                  },
                  {
                    "name": "Failed",
                    "enumValue": "failed"
                  }
                ]
              }
            }
          ]
        }
      }
    },
    {
      "@type": "Command",
      "name": "createDiscoveredAsset",
      "request": {
        "name": "createDiscoveredAssetRequest",
        "displayName": "Discovered Asset Create Request",
        "description": "Create a new discovered asset.",
        "schema": {
          "@type": "Object",
          "fields": [
            {
              "@type": "Field",
              "name": "assetName",
              "description": "Name of the asset if available.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "assetEndpointProfileRef",
              "description": "A reference to the asset endpoint profile.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "manufacturer",
              "description": "Asset manufacturer name.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "manufacturerUri",
              "description": "URI to the manufacturer of the asset.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "model",
              "description": "Asset model name.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "productCode",
              "description": "Asset product code.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "hardwareRevision",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "softwareRevision",
              "description": "Revision number of the software.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "documentationUri",
              "description": "URI to the documentation of the asset.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "serialNumber",
              "description": "Asset serial number.",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "defaultDatasetsConfiguration",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "defaultEventsConfiguration",
              "schema": "string"
            },
            {
              "@type": "Field",
              "name": "defaultTopic",
              "schema": {
                "@type": "Object",
                "fields": [
                  {
                    "name": "path",
                    "schema": "string"
                  },
                  {
                    "name": "retain",
                    "schema": "dtmi:com:microsoft:deviceregistry:DiscoveredTopicRetain;1"
                  }
                ]
              }
            },
            {
              "@type": "Field",
              "name": "datasets",
              "description": "Array of datasets that are part of the asset. Each dataset spec describes the datapoints that make up the set.",
              "schema": {
                "@type": "Array",
                "elementSchema": {
                  "@type": "Object",
                  "fields": [
                    {
                      "name": "name",
                      "schema": "string"
                    },
                    {
                      "name": "dataSetConfiguration",
                      "schema": "string"
                    },
                    {
                      "name": "topic",
                      "schema": {
                        "@type": "Object",
                        "fields": [
                          {
                            "name": "path",
                            "schema": "string"
                          },
                          {
                            "name": "retain",
                            "schema": "dtmi:com:microsoft:deviceregistry:DiscoveredTopicRetain;1"
                          }
                        ]
                      }
                    },
                    {
                      "name": "dataPoints",
                      "schema": {
                        "@type": "Array",
                        "elementSchema": {
                          "@type": "Object",
                          "fields": [
                            {
                              "name": "name",
                              "schema": "string"
                            },
                            {
                              "name": "dataSource",
                              "schema": "string"
                            },
                            {
                              "name": "dataPointConfiguration",
                              "schema": "string"
                            },
                            {
                              "name": "lastUpdatedOn",
                              "schema": "string"
                            }
                          ]
                        }
                      }
                    }
                  ]
                }
              }
            },
            {
              "@type": "Field",
              "name": "events",
              "description": "Array of events that are part of the asset. Each event can reference an asset type capability and have per-event configuration.",
              "schema": {
                "@type": "Array",
                "elementSchema": {
                  "@type": "Object",
                  "fields": [
                    {
                      "name": "name",
                      "schema": "string"
                    },
                    {
                      "name": "eventNotifier",
                      "schema": "string"
                    },
                    {
                      "name": "eventConfiguration",
                      "schema": "string"
                    },
                    {
                      "name": "topic",
                      "schema": {
                        "@type": "Object",
                        "fields": [
                          {
                            "name": "path",
                            "schema": "string"
                          },
                          {
                            "name": "retain",
                            "schema": "dtmi:com:microsoft:deviceregistry:DiscoveredTopicRetain;1"
                          }
                        ]
                      }
                    },
                    {
                      "name": "lastUpdatedOn",
                      "schema": "string"
                    }
                  ]
                }
              }
            }
          ]
        }
      },
      "response": {
        "name": "createDiscoveredAssetResponse",
        "displayName": "Discovered Asset Create Response",
        "description": "Response to a discovered asset create request.",
        "schema": {
          "@type": "Object",
          "fields": [
            {
              "@type": "Field",
              "name": "status",
              "description": "status of discovered asset creation",
              "schema": {
                "@type": "Enum",
                "valueSchema": "string",
                "enumValues": [
                  {
                    "name": "Created",
                    "enumValue": "created"
                  },
                  {
                    "name": "Duplicate",
                    "enumValue": "duplicate"
                  },
                  {
                    "name": "Failed",
                    "enumValue": "failed"
                  }
                ]
              }
            }
          ]
        }
      }
    }
  ],
  "schemas": [
    {
      "@id": "dtmi:com:microsoft:deviceregistry:DiscoveredTopicRetain;1",
      "@type": "Enum",
      "description": "When set to Keep, messages published to MQTT Broker will have the retain flag set.",
      "valueSchema": "string",
      "enumValues": [
        {
          "name": "Keep",
          "enumValue": "Keep"
        },
        {
          "name": "Never",
          "enumValue": "Never"
        }
      ]

    }
  ]
}