/* Code generated by Azure.Iot.Operations.ProtocolCompiler v0.6.0.0; DO NOT EDIT. */
#![allow(non_camel_case_types)]

use std::io::Cursor;

use apache_avro;
use azure_iot_operations_protocol::common::payload_serialize::{FormatIndicator, PayloadSerialize};
use lazy_static;

use super::telemetry_collection::TelemetryCollection;

impl PayloadSerialize for TelemetryCollection {
    type Error = apache_avro::Error;

    fn content_type() -> &'static str {
        "application/avro"
    }

    fn format_indicator() -> FormatIndicator {
        FormatIndicator::UnspecifiedBytes
    }

    fn serialize(self) -> Result<Vec<u8>, Self::Error> {
        match apache_avro::to_value(&self) {
            Ok(v) => apache_avro::to_avro_datum(&SCHEMA, v),
            Err(e) => Err(e),
        }
    }

    fn deserialize(payload: &[u8]) -> Result<Self, Self::Error> {
        match apache_avro::from_avro_datum(&SCHEMA, &mut Cursor::new(payload), None) {
            Ok(v) => apache_avro::from_value(&v),
            Err(e) => Err(e),
        }
    }
}

lazy_static::lazy_static! { pub static ref SCHEMA: apache_avro::Schema = apache_avro::Schema::parse_str(RAW_SCHEMA).unwrap(); }

const RAW_SCHEMA: &str = r#"
{
  "namespace": "avro_comm.dtmi_codegen_communicationTest_avroModel__1",
  "name": "TelemetryCollection",
  "type": "record",
  "fields": [
    {
      "name": "lengths",
      "type": [
        "null",
        {
          "type": "array",
          "items": {
            "type": "double"
          },
          "default": []
        }
      ]
    },
    {
      "name": "proximity",
      "type": [
        "null",
        {
          "name": "Enum_Proximity",
          "type": "enum",
          "symbols": [ "near", "far" ]
        }
      ]
    },
    {
      "name": "schedule",
      "type": [
        "null",
        {
          "name": "Object_Schedule",
          "type": "record",
          "fields": [
            {
              "name": "course",
              "type": [
                "null",
                {
                  "type": "string"
                }
              ]
            },
            {
              "name": "credit",
              "type": [
                "null",
                {
                  "type": "string"
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
"#;
