{
  "@context": [
    "https://www.w3.org/2022/wot/td/v1.1",
    { "dtv": "http://azure.com/DigitalTwins/dtmi#" }
  ],
  "@type": "tm:ThingModel",
  "title": "CounterCollection",
  "links": [
    {
      "rel": "dtv:naming",
      "href": "./CounterCollection.SchemaNames.json",
      "type": "application/json"
    }
  ],
  "schemaDefinitions": {
    "condition": {
      "title": "ErrorCondition",
      "type": "string",
      "enum": [
        "NotFound",
        "Overflow"
      ]
    },
    "errorCondition": {
      "title": "ErrorCondition",
      "type": "string",
      "enum": [
        "NotFound",
        "Overflow"
      ]
    },
    "availableCounters": {
      "title": "CounterList",
      "type": "object",
      "properties": {
        "counterNames": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "extantCounters": {
      "title": "CounterList",
      "type": "object",
      "properties": {
        "counterNames": {
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      }
    },
    "locationError": {
      "title": "CounterError",
      "description": "The requested counter operation could not be completed.",
      "type": "object",
      "dtv:errorMessage": "explanation",
      "properties": {
        "explanation": {
          "type": "string"
        }
      }
    }
  },
  "actions": {
    "increment": {
      "input": {
        "type": "object",
        "required": [ "counterName" ],
        "properties": {
          "counterName": {
            "type": "string"
          }
        }
      },
      "output": {
        "type": "object",
        "required": [ "counterValue" ],
        "properties": {
          "counterValue": {
            "type": "integer",
            "minimum": -2147483648,
            "maximum": 2147483647
          }
        }
      },
      "forms": [
        {
          "contentType": "application/json",
          "dtv:headerInfo": [
            {
              "contentType": "application/json",
              "schema": "extantCounters"
            }
          ],
          "dtv:headerCode": "errorCondition",
          "dtv:topic": "test/CounterCollection/increment",
          "op": "invokeaction"
        }
      ]
    },
    "getLocation": {
      "input": {
        "type": "object",
        "required": [ "counterName" ],
        "properties": {
          "counterName": {
            "description": "Name of counter whose location to determine",
            "type": "string"
          }
        }
      },
      "output": {
        "type": "object",
        "properties": {
          "counterLocation": {
            "title": "CounterLocation",
            "description": "Location of counter, null if not deployed",
            "type": "object",
            "required": [ "latitude", "longitude" ],
            "properties": {
              "latitude": {
                "type": "number",
                "minimum": -1.80e+308,
                "maximum": 1.80e+308
              },
              "longitude": {
                "type": "number",
                "minimum": -1.80e+308,
                "maximum": 1.80e+308
              }
            }
          }
        }
      },
      "forms": [
        {
          "contentType": "application/json",
          "additionalResponses": [
            {
              "success": false,
              "schema": "locationError"
            }
          ],
          "dtv:headerInfo": [
            {
              "contentType": "application/json",
              "schema": "availableCounters"
            }
          ],
          "dtv:headerCode": "condition",
          "dtv:topic": "test/CounterCollection/getLocation",
          "op": "invokeaction"
        }
      ]
    }
  }
}
